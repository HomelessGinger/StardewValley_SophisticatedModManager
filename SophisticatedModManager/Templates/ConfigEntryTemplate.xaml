<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:vm="clr-namespace:SophisticatedModManager.ViewModels"
                    xmlns:models="clr-namespace:SophisticatedModManager.Models">

    <!-- Config entry template (self-referencing for nested objects) -->
    <DataTemplate x:Key="ConfigEntryTemplate" DataType="{x:Type vm:ConfigEntryViewModel}">
        <StackPanel>
            <Border Padding="4,4" Margin="0,1"
                    Background="Transparent"
                    BorderBrush="{StaticResource ConfigBorderBrush}" BorderThickness="0,0,0,1">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="160"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Key name (read-only) -->
                    <TextBlock Grid.Column="0"
                               Text="{Binding Key}"
                               FontWeight="SemiBold" FontSize="12"
                               Foreground="{StaticResource DarkEarthBrush}"
                               VerticalAlignment="Center"
                               TextTrimming="CharacterEllipsis"
                               ToolTip="{Binding Key}"/>

                    <!-- Boolean: CheckBox -->
                    <CheckBox Grid.Column="1"
                              IsChecked="{Binding BoolValue}"
                              VerticalAlignment="Center">
                        <CheckBox.Style>
                            <Style TargetType="CheckBox" BasedOn="{StaticResource StardewCheckBox}">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ValueType}"
                                                 Value="{x:Static models:ConfigValueType.Boolean}">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </CheckBox.Style>
                    </CheckBox>

                    <!-- String: TextBox -->
                    <TextBox Grid.Column="1"
                             Text="{Binding StringValue, UpdateSourceTrigger=PropertyChanged}"
                             FontSize="12" Padding="6,4">
                        <TextBox.Style>
                            <Style TargetType="TextBox" BasedOn="{StaticResource StardewTextBox}">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ValueType}"
                                                 Value="{x:Static models:ConfigValueType.String}">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                    </TextBox>

                    <!-- Number: TextBox -->
                    <TextBox Grid.Column="1"
                             Text="{Binding StringValue, UpdateSourceTrigger=PropertyChanged}"
                             FontSize="12" Padding="6,4">
                        <TextBox.Style>
                            <Style TargetType="TextBox" BasedOn="{StaticResource StardewTextBox}">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ValueType}"
                                                 Value="{x:Static models:ConfigValueType.Number}">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                    </TextBox>

                    <!-- Array: Multi-line TextBox -->
                    <TextBox Grid.Column="1"
                             Text="{Binding StringValue, UpdateSourceTrigger=PropertyChanged}"
                             FontSize="11" Padding="6,4"
                             AcceptsReturn="True" TextWrapping="Wrap"
                             MaxHeight="80"
                             VerticalScrollBarVisibility="Auto">
                        <TextBox.Style>
                            <Style TargetType="TextBox" BasedOn="{StaticResource StardewTextBox}">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ValueType}"
                                                 Value="{x:Static models:ConfigValueType.Array}">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBox.Style>
                    </TextBox>

                    <!-- Object: label showing child count -->
                    <TextBlock Grid.Column="1"
                               Text="{Binding Children.Count, StringFormat='{}{0} field(s)'}"
                               FontSize="11" FontStyle="Italic"
                               Foreground="{StaticResource SubtleTextBrush}"
                               VerticalAlignment="Center">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ValueType}"
                                                 Value="{x:Static models:ConfigValueType.Object}">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>

                    <!-- Null: read-only label -->
                    <TextBlock Grid.Column="1"
                               Text="null"
                               FontSize="11" FontStyle="Italic"
                               Foreground="{StaticResource MutedTextBrush}"
                               VerticalAlignment="Center">
                        <TextBlock.Style>
                            <Style TargetType="TextBlock">
                                <Setter Property="Visibility" Value="Collapsed"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding ValueType}"
                                                 Value="{x:Static models:ConfigValueType.Null}">
                                        <Setter Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </TextBlock.Style>
                    </TextBlock>
                </Grid>
            </Border>

            <!-- Children for Object type (recursive) -->
            <ItemsControl ItemsSource="{Binding Children}" Margin="20,0,0,0"
                          ItemTemplate="{DynamicResource ConfigEntryTemplate}">
                <ItemsControl.Style>
                    <Style TargetType="ItemsControl">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ValueType}"
                                         Value="{x:Static models:ConfigValueType.Object}">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ItemsControl.Style>
            </ItemsControl>
        </StackPanel>
    </DataTemplate>

</ResourceDictionary>
