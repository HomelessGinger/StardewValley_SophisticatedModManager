<UserControl x:Class="SophisticatedModManager.Views.Overlays.SaveCategorizationOverlay"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="clr-namespace:SophisticatedModManager.ViewModels"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DataContext="{d:DesignInstance Type=vm:MainViewModel}">
    <Border Background="{StaticResource ContentBgBrush}" Padding="30,20">
        <DockPanel MaxWidth="600" HorizontalAlignment="Center">
            <!-- First-load context header -->
            <TextBlock DockPanel.Dock="Top" Text="Categorize Save Files"
                       FontSize="20" FontWeight="Bold"
                       Foreground="{StaticResource WoodBrownBrush}"
                       Margin="0,0,0,8"
                       Visibility="{Binding IsReassigningDeletedProfileSaves, Converter={StaticResource BoolToVis}, ConverterParameter=Invert}"/>
            <TextBlock DockPanel.Dock="Top" TextWrapping="Wrap" FontSize="12"
                       Foreground="{StaticResource SubtleTextBrush}" Margin="0,0,0,16"
                       Visibility="{Binding IsReassigningDeletedProfileSaves, Converter={StaticResource BoolToVis}, ConverterParameter=Invert}">
                Mod profiles were found, but save files haven't been assigned to profiles yet.
                Please assign each save file to the profile it belongs with. This helps in eliminating accidental openings of farms.
                Failure to do this step may lead to farms not being matched with their correct mods.
            </TextBlock>

            <!-- Delete-reassignment context header -->
            <TextBlock DockPanel.Dock="Top" Text="Reassign Save Files"
                       FontSize="20" FontWeight="Bold"
                       Foreground="{StaticResource WoodBrownBrush}"
                       Margin="0,0,0,8"
                       Visibility="{Binding IsReassigningDeletedProfileSaves, Converter={StaticResource BoolToVis}}"/>
            <TextBlock DockPanel.Dock="Top" TextWrapping="Wrap" FontSize="12"
                       Foreground="{StaticResource SubtleTextBrush}" Margin="0,0,0,16"
                       Visibility="{Binding IsReassigningDeletedProfileSaves, Converter={StaticResource BoolToVis}}">
                Choose which profiles should receive this profile's saves. Unassigned saves will be deleted with the profile.
            </TextBlock>

            <StackPanel DockPanel.Dock="Bottom" Margin="0,12,0,0">
                <StackPanel Orientation="Horizontal">
                    <Button Content="Confirm"
                            Style="{StaticResource StardewButton}"
                            Command="{Binding ConfirmSaveCategorizationCommand}"
                            Margin="0,0,8,0"/>
                    <Button Command="{Binding SkipSaveCategorizationCommand}">
                        <Button.Style>
                            <Style TargetType="Button" BasedOn="{StaticResource StardewButton}">
                                <Setter Property="Content" Value="Skip (not recommended)"/>
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsReassigningDeletedProfileSaves}" Value="True">
                                        <Setter Property="Content" Value="Cancel"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
                <Button Style="{StaticResource WikiLinkButton}"
                        Command="{Binding OpenWikiCommand}"
                        Visibility="{Binding IsReassigningDeletedProfileSaves, Converter={StaticResource BoolToVis}, ConverterParameter=Invert}"/>
            </StackPanel>

            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <ItemsControl ItemsSource="{Binding SavesToCategorize}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate DataType="{x:Type vm:SaveCategoryItem}">
                            <Border Background="{StaticResource CardBgBrush}"
                                    BorderBrush="{StaticResource CardBorderBrush}"
                                    BorderThickness="1" CornerRadius="4"
                                    Padding="10,8" Margin="0,0,0,6">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="200"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                               Text="{Binding SaveFolderName}"
                                               FontWeight="SemiBold" FontSize="13"
                                               Foreground="{StaticResource DarkEarthBrush}"
                                               VerticalAlignment="Center"/>
                                    <ComboBox Grid.Column="1"
                                              ItemsSource="{Binding AvailableProfiles}"
                                              SelectedItem="{Binding AssignedProfileName}"
                                              FontSize="12"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
        </DockPanel>
    </Border>
</UserControl>
